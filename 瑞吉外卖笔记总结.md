# 瑞吉外卖笔记总结

# 搭建项目

这里看第一周的文件夹，有完整的代码实现

1. 引入POM文件以及核心配置文件

## 核心配置文件的内容重点

mybatis-plusli的一个配置是`map-underscore-to-camel-case: true` 这个配置可以让映射实体或者属性的时候，将数据库中的表名和字段名中的下划线去掉，按照驼峰命名法来进行映射

- 示例: 如果表名是`address_book`, 通过这个配置就可以自动匹配成实体类需要的`AddressBook`

## 设置静态资源映射

WebMvcConfig文件实现这一点

- 通过配置addResourceHandlers方法，可以将resources文件夹中的backend和frontend部分的代码设置静态资源映射。

- 这样就可以让浏览器发送的请求映射到resources文件夹中的backend和frontend部分的URL了，就可以直接在文件夹中定位了。因为常规情况下，是需要把这些前端代码放在template或者static文件夹下面的。

# 实现登录功能

## 前端的handleLogin方法

通过查看前端的登录按钮，发现请求发送是通过前端页面中的`handleLogin`方法，可以发现前端的界面是需要3个信息来进行确认的，也就是`code`, `data`和`msg`

这三个数据确定了登录是否成功的重要指标。

在这个方法中使用到了`loginApi`方法来确定ajax的请求发送的路由。

## 定义EmployeeController

想要实现login方法，就要准备好Employee相关的代码。

1. 实现`Employee`实体类
2. 使用MyBatis-Plus来确定`EmployeeMapper`接口
3. 实现服务层接口以及实现类，`EmployeeService`和`EmployeeServiceImpl`

## 定义R通用类

对应着handleLogin方法中涉及到的`code`, `data`和`msg`这三个属性, 并且使用一个hashmap来存储动态数据。

定义`success`，`error`方法，不同的方法传递不同的值给前端的对应的属性。

## 实现login方法

主要是通过6个步骤: 

1. 页面提交的密码进行md5加密处理
2. 根据页面提交的用户名查询数据库
3. 如果没有查询到username则返回登录失败结果
4. 密码比对，如果不一致则返回登录失败结果
5. 查看员工状态，如果为已禁用状态，则返回‘员工已禁用’结果
6. 登陆成功，**将员工id存入session**并返回登陆成功结果

主要有意思的点就是在于第6点，登录成功还是通过handleLogin方法，通过loginApi方法发送了请求，**存储到了浏览器中的localStorage**。这样未来想要取employee id的时候就可以随时从session中取出。

# 实现登出功能

1. 清理session中保存的当前登录员工的id